Device Provisioning:
┌─────────────────┐
│   Root Key      │ ← Pre-installed shared secret
│   (32 bytes)    │
└─────────────────┘
         │
         v (one-time use)
┌─────────────────┐
│ First Session   │ ← HKDF(root_key, counter=0)
│ Keys (enc+scr)  │
└─────────────────┘
         │
         v (ratcheting)
┌─────────────────┐
│ Next Session    │ ← HKDF(prev_keys, counter=n)
│ Keys (enc+scr)  │
└─────────────────┘

Outbound Message:
Plaintext → AES-GCM(enc_key) → Scramble(scr_key) → Packet → Network

Inbound Message:
Network → Packet → Unscramble(scr_key) → AES-GCM(enc_key) → Plaintext

